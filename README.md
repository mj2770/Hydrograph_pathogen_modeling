# Hydrograph-based-approach-to-modeling-bacteria-level-in-Hudson-River
The final project for the "Field Methods for Environmental Engineering" course involves predicting the MPN (Enterococcus) levels in the Hudson River for 2018. This prediction is based on a model fitted to historical MPN-TSR (time since rain) data. 
The project aims to understand and forecast the fecal pollution levels in the Hudson River using Enterococcus as an indicator. By leveraging historical data and advanced modeling techniques, the script provides insights into the relationship between MPN levels and environmental factors, such as time since rain (TSR).
# Data Resources:
## Citizens' Water Quality Testing Program:
The weekly water samples were collected by volunteers from local boathouses and community groups at boat launches and docks from Yonkers to Jamaica Bay. Using EPA-approved kits from IDEXX laboratories, community scientists at The River Project test the samples for microbes of the genus Enterococcus.  They publish test results every Friday evening throughout the boating season. 
## National Climatic Data Center, NOAA
From the NCDC database, we requested Global Hourly Surface Data for the Central park station in New York, which is not far from our sampling site in west harlem pier harbour. 
## Real time CP weather data from Data Garrison Satellite Station
Precipitation data (in inch) with date-time at the interval of 15 minutes per observation.

# Analysis steps:
## **Data clean-up**
After ordering the data from NOAA, we read them in R studio. First, we clean the data:  rule out the missing data(“*****”)in the hourly precipitation record. As the raw data has the column “GMT” in the format of “201705010051”, so we cut up the columns into 4 different columns, “month, day, hour, pcp01” Then we transfer the date-time into a fractional time, considering the specific moment of the day.  
Next, we perform the selecting algorithm to filter qualified rain events.
## **Filter Qualified Rain Events**
We are not going to employ rain events with 8 hours accumulated precipitation smaller than 0.25 inches, as there may not be CSO generated by these relatively smaller precipitations.
First, the earth and land surface will take in some storm water, precipitation will not fully transformed into runoff. In addition, the combined sewer system possess some capacity for the additional storm water in wet weathers, so unless the runoff is large enough, the mixture of rainwater and sewer water will go to the water treatment plant, without generating CSO or causing bacteria in Hudson river.
## **Fitted MPN-TSR Relation**
Given the past year precipitation-bacteria data frame produced in the last step, we now combine it with our sampling WQ results. Then, we convert the normal yeartime column into time since rain for each rain event. The CSO for each qualified rain event will not be detected immediately in rain as the generation of runoff needs time. So taking the TSR instead of yeartime will help us plot the hydrograph of MPN-TSR for the later lag time. Also, it prevents us from taking samples in the showers of rain.
Next, we plot the data points on a MPN-TSR chart, fitting with Linear and exponential regression model.

<img width="398" height="278" alt="image" src="https://github.com/user-attachments/assets/185fc22f-488b-4241-9c1a-6237bea3bf7b" />

## **Long-term MPN Prediction**
In this part, the major goal is using the MPN-TSR fitting curve to predict the long-term MPN conditions in the rivers and plotting the time-series data graph. 

<img width="392" height="286" alt="image" src="https://github.com/user-attachments/assets/96b75f18-9640-4348-9fc5-10006bd55fc1" />

<img width="392" height="286" alt="image" src="https://github.com/user-attachments/assets/d032b0d3-d39d-46aa-9b84-4a2cba2c1aa4" />

<img width="386" height="286" alt="image" src="https://github.com/user-attachments/assets/c34f5fab-4bb3-48f1-b08c-dbe2717d9b01" />



